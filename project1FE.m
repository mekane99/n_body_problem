clear all
close all
clc

tic
%Parameters and Initial Conditions
G = 6.6743e-11;
m_1 = 1.9891e30; %mass of 1
m_2 = .330e24; %mass of Mercury
m_3 = 4.87e24; %mass of Venus
m_4 = 5.97e24;%Earth
m_5 = .642e24;%Mars
m_6 = 1898e24;%Jupiter
m_7 = 568e24;%Saturn
m_8 = 86.8e24;%Uranus
m_9 = 102e24;%Neptune
m_10 = .0146e24;%pluto

time = 7.92e09; %how long to run simulation
%time = 100000000;
h = 100000; %time step

[position_mercury,velocity_mercury] = planetEphemeris(juliandate(2019,3,29),'Sun','Mercury');
[position_venus,velocity_venus] = planetEphemeris(juliandate(2019,3,29),'Sun','Venus');
[position_earth,velocity_earth] = planetEphemeris(juliandate(2019,3,29),'Sun','Earth');
[position_mars,velocity_mars] = planetEphemeris(juliandate(2019,3,29),'Sun','Mars');
[position_jupiter,velocity_jupiter] = planetEphemeris(juliandate(2019,3,29),'Sun','Jupiter');
[position_saturn,velocity_saturn] = planetEphemeris(juliandate(2019,3,29),'Sun','Saturn');
[position_uranus,velocity_uranus] = planetEphemeris(juliandate(2019,3,29),'Sun','Uranus');
[position_neptune,velocity_neptune] = planetEphemeris(juliandate(2019,3,29),'Sun','Neptune');
[position_pluto,velocity_pluto] = planetEphemeris(juliandate(2019,3,29),'Sun','Pluto');

%initial conditions
r_1 = [0;0;0]; %position Sun
r_2 =  position_mercury*10^3;%position Mercury
r_3 =  position_venus*10^3;%Venus
r_4 =  position_earth*10^3;%Earth
r_5 = position_mars*10^3;%Mars
r_6 = position_jupiter*10^3;%Jupiter
r_7 = position_saturn*10^3;%Saturn
r_8 = position_uranus*10^3;%Uranus
r_9 = position_neptune*10^3;%Neptune
r_10 = position_pluto*10^3;%Pluto


x_2 = r_2(1);
y_2 = r_2(2);
z_2 = r_2(3);

x_3 = r_3(1);
y_3 = r_3(2);
z_3 = r_3(3);

x_4 = r_4(1);
y_4 = r_4(2);
z_4 = r_4(3);

x_5 = r_5(1);
y_5 = r_5(2);
z_5 = r_5(3);

x_6 = r_6(1);
y_6 = r_6(2);
z_6 = r_6(3);

x_7 = r_7(1);
y_7 = r_7(2);
z_7 = r_7(3);

x_8 = r_8(1);
y_8 = r_8(2);
z_8 = r_8(3);

x_9 = r_9(1);
y_9 = r_9(2);
z_9 = r_9(3);
x_10 = r_10(1);
y_10 = r_10(2);
z_10 = r_10(3);

v_1 = [0;0;0];    %center body
v_2 = velocity_mercury*10^3;   %second body
v_3 = velocity_venus*10^3;
v_4 = velocity_earth*10^3;
v_5 = velocity_mars*10^3;
v_6 = velocity_jupiter*10^3;
v_7 = velocity_saturn*10^3;
v_8 = velocity_uranus*10^3;
v_9 = velocity_neptune*10^3;
v_10 = velocity_pluto*10^3;

r_2keep = zeros(3,time/h);
r_3keep = zeros(3,time/h);
r_4keep = zeros(3,time/h);
r_5keep = zeros(3,time/h);
r_6keep = zeros(3,time/h);
r_7keep = zeros(3,time/h);
r_8keep = zeros(3,time/h);
r_9keep = zeros(3,time/h);
r_10keep = zeros(3,time/h);
a_2keep = zeros(3,time/h);


%Acceleration Body Mercury(2)
f2x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_2(1)) / norm(r_1-r_2) ^3 + ...
    m_3 * (r_3(1) - r_2(1)) / norm(r_3 - r_2) ^3 + ...
    m_4 * (r_4(1) - r_2(1)) / norm(r_4 - r_2) ^3 + ...
    m_5 * (r_5(1) - r_2(1)) / norm(r_5 - r_2) ^3 + ...
    m_6 * (r_6(1) - r_2(1)) / norm(r_6 - r_2) ^3 + ...
    m_7 * (r_7(1) - r_2(1)) / norm(r_7 - r_2) ^3 + ...
    m_8 * (r_8(1) - r_2(1)) / norm(r_8 - r_2) ^3 + ...
    m_9 * (r_9(1) - r_2(1)) / norm(r_9 - r_2) ^3 + ...
    m_10 * (r_10(1) - r_2(1)) / norm(r_10 - r_2) ^3);
f2y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_2(2)) / norm(r_1-r_2) ^3 + ...
    m_3 * (r_3(2) - r_2(2)) / norm(r_3 - r_2) ^3 + ...
    m_4 * (r_4(2) - r_2(2)) / norm(r_4 - r_2) ^3 + ...
    m_5 * (r_5(2) - r_2(2)) / norm(r_5 - r_2) ^3 + ...
    m_6 * (r_6(2) - r_2(2)) / norm(r_6 - r_2) ^3 + ...
    m_7 * (r_7(2) - r_2(2)) / norm(r_7 - r_2) ^3 + ...
    m_8 * (r_8(2) - r_2(2)) / norm(r_8 - r_2) ^3 + ...
    m_9 * (r_9(2) - r_2(2)) / norm(r_9 - r_2) ^3 + ...
    m_10 * (r_10(2) - r_2(2)) / norm(r_10 - r_2) ^3);
f2z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_2(3)) / norm(r_1-r_2) ^3 + ...
    m_3 * (r_3(3) - r_2(3)) / norm(r_3 - r_2) ^3 + ...
    m_4 * (r_4(3) - r_2(3)) / norm(r_4 - r_2) ^3 + ...
    m_5 * (r_5(3) - r_2(3)) / norm(r_5 - r_2) ^3 + ...
    m_6 * (r_6(3) - r_2(3)) / norm(r_6 - r_2) ^3 + ...
    m_7 * (r_7(3) - r_2(3)) / norm(r_7 - r_2) ^3 + ...
    m_8 * (r_8(3) - r_2(3)) / norm(r_8 - r_2) ^3 + ...
    m_9 * (r_9(3) - r_2(3)) / norm(r_9 - r_2) ^3 + ...
    m_10 * (r_10(3) - r_2(3)) / norm(r_10 - r_2) ^3);

%Acceleration Body Venus(3)
f3x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_2 * (r_2(1) - r_3(1)) / norm(r_2-r_3) ^3 + ...
    m_1 * (r_1(1) - r_3(1)) / norm(r_1 - r_3) ^3 + ...
    m_4 * (r_4(1) - r_3(1)) / norm(r_4 - r_3) ^3 + ...
    m_5 * (r_5(1) - r_3(1)) / norm(r_5 - r_3) ^3 + ...
    m_6 * (r_6(1) - r_3(1)) / norm(r_6 - r_3) ^3 + ...
    m_7 * (r_7(1) - r_3(1)) / norm(r_7 - r_3) ^3 + ...
    m_8 * (r_8(1) - r_3(1)) / norm(r_8 - r_3) ^3 + ...
    m_9 * (r_9(1) - r_3(1)) / norm(r_9 - r_3) ^3 + ...
    m_10 * (r_10(1) - r_3(1)) / norm(r_10 - r_3) ^3);
f3y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_2 * (r_2(2) - r_3(2)) / norm(r_2-r_3) ^3 + ...
    m_1 * (r_1(2) - r_3(2)) / norm(r_1 - r_3) ^3 + ...
    m_4 * (r_4(2) - r_3(2)) / norm(r_4 - r_3) ^3 + ...
    m_5 * (r_5(2) - r_3(2)) / norm(r_5 - r_3) ^3 + ...
    m_6 * (r_6(2) - r_3(2)) / norm(r_6 - r_3) ^3 + ...
    m_7 * (r_7(2) - r_3(2)) / norm(r_7 - r_3) ^3 + ...
    m_8 * (r_8(2) - r_3(2)) / norm(r_8 - r_3) ^3 + ...
    m_9 * (r_9(2) - r_3(2)) / norm(r_9 - r_3) ^3 + ...
    m_10 * (r_10(2) - r_3(2)) / norm(r_10 - r_3) ^3);
f3z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_2 * (r_2(3) - r_3(3)) / norm(r_2-r_3) ^3 + ...
    m_1 * (r_1(3) - r_3(3)) / norm(r_1 - r_3) ^3 + ...
    m_4 * (r_4(3) - r_3(3)) / norm(r_4 - r_3) ^3 + ...
    m_5 * (r_5(3) - r_3(3)) / norm(r_5 - r_3) ^3 + ...
    m_6 * (r_6(3) - r_3(3)) / norm(r_6 - r_3) ^3 + ...
    m_7 * (r_7(3) - r_3(3)) / norm(r_7 - r_3) ^3 + ...
    m_8 * (r_8(3) - r_3(3)) / norm(r_8 - r_3) ^3 + ...
    m_9 * (r_9(3) - r_3(3)) / norm(r_9 - r_3) ^3 + ...
    m_10 * (r_10(3) - r_3(3)) / norm(r_10 - r_3) ^3);

%Acceleration Body Earth(4)
f4x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_4(1)) / norm(r_1 - r_4) ^3 + ...
    m_2 * (r_2(1) - r_4(1)) / norm(r_2 - r_4) ^3 + ...
    m_3 * (r_3(1) - r_4(1)) / norm(r_3 - r_4) ^3 + ...
    m_5 * (r_5(1) - r_4(1)) / norm(r_5 - r_4) ^3 + ...
    m_6 * (r_6(1) - r_4(1)) / norm(r_6 - r_4) ^3 + ...
    m_7 * (r_7(1) - r_4(1)) / norm(r_7 - r_4) ^3 + ...
    m_8 * (r_8(1) - r_4(1)) / norm(r_8 - r_4) ^3 + ...
    m_9 * (r_9(1) - r_4(1)) / norm(r_9 - r_4) ^3 + ...
    m_10 * (r_10(1) - r_4(1)) / norm(r_10 - r_4) ^3);
f4y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_4(2)) / norm(r_1 - r_4) ^3 + ...
    m_2 * (r_2(2) - r_4(2)) / norm(r_2 - r_4) ^3 + ...
    m_3 * (r_3(2) - r_4(2)) / norm(r_3 - r_4) ^3 + ...
    m_5 * (r_5(2) - r_4(2)) / norm(r_5 - r_4) ^3 + ...
    m_6 * (r_6(2) - r_4(2)) / norm(r_6 - r_4) ^3 + ...
    m_7 * (r_7(2) - r_4(2)) / norm(r_7 - r_4) ^3 + ...
    m_8 * (r_8(2) - r_4(2)) / norm(r_8 - r_4) ^3 + ...
    m_9 * (r_9(2) - r_4(2)) / norm(r_9 - r_4) ^3 + ...
    m_10 * (r_10(2) - r_4(2)) / norm(r_10 - r_4) ^3);
f4z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_4(3)) / norm(r_1 - r_4) ^3 + ...
    m_2 * (r_2(3) - r_4(3)) / norm(r_2 - r_4) ^3 + ...
    m_3 * (r_3(3) - r_4(3)) / norm(r_3 - r_4) ^3 + ...
    m_5 * (r_5(3) - r_4(3)) / norm(r_5 - r_4) ^3 + ...
    m_6 * (r_6(3) - r_4(3)) / norm(r_6 - r_4) ^3 + ...
    m_7 * (r_7(3) - r_4(3)) / norm(r_7 - r_4) ^3 + ...
    m_8 * (r_8(3) - r_4(3)) / norm(r_8 - r_4) ^3 + ...
    m_9 * (r_9(3) - r_4(3)) / norm(r_9 - r_4) ^3 + ...
    m_10 * (r_10(3) - r_4(3)) / norm(r_10 - r_4) ^3);

%Acceleration Body Mars(5)
f5x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_5(1)) / norm(r_1-r_5) ^3 + ...
    m_2 * (r_2(1) - r_5(1)) / norm(r_2 - r_5) ^3 + ...
    m_3 * (r_3(1) - r_5(1)) / norm(r_3 - r_5) ^3 + ...
    m_4 * (r_4(1) - r_5(1)) / norm(r_4 - r_5) ^3 + ...
    m_6 * (r_6(1) - r_5(1)) / norm(r_6 - r_5) ^3 + ...
    m_7 * (r_7(1) - r_5(1)) / norm(r_7 - r_5) ^3 + ...
    m_8 * (r_8(1) - r_5(1)) / norm(r_8 - r_5) ^3 + ...
    m_9 * (r_9(1) - r_5(1)) / norm(r_9 - r_5) ^3 + ...
    m_10 * (r_10(1) - r_5(1)) / norm(r_10 - r_5) ^3);
f5y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_5(2)) / norm(r_1-r_5) ^3 + ...
    m_2 * (r_2(2) - r_5(2)) / norm(r_2 - r_5) ^3 + ...
    m_3 * (r_3(2) - r_5(2)) / norm(r_3 - r_5) ^3 + ...
    m_4 * (r_4(2) - r_5(2)) / norm(r_4 - r_5) ^3 + ...
    m_6 * (r_6(2) - r_5(2)) / norm(r_6 - r_5) ^3 + ...
    m_7 * (r_7(2) - r_5(2)) / norm(r_7 - r_5) ^3 + ...
    m_8 * (r_8(2) - r_5(2)) / norm(r_8 - r_5) ^3 + ...
    m_9 * (r_9(2) - r_5(2)) / norm(r_9 - r_5) ^3 + ...
    m_10 * (r_10(2) - r_5(2)) / norm(r_10 - r_5) ^3);
f5z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_5(3)) / norm(r_1-r_5) ^3 + ...
    m_2 * (r_2(3) - r_5(3)) / norm(r_2 - r_5) ^3 + ...
    m_3 * (r_3(3) - r_5(3)) / norm(r_3 - r_5) ^3 + ...
    m_4 * (r_4(3) - r_5(3)) / norm(r_4 - r_5) ^3 + ...
    m_6 * (r_6(3) - r_5(3)) / norm(r_6 - r_5) ^3 + ...
    m_7 * (r_7(3) - r_5(3)) / norm(r_7 - r_5) ^3 + ...
    m_8 * (r_8(3) - r_5(3)) / norm(r_8 - r_5) ^3 + ...
    m_9 * (r_9(3) - r_5(3)) / norm(r_9 - r_5) ^3 + ...
    m_10 * (r_10(3) - r_5(3)) / norm(r_10 - r_5) ^3);

%Acceleration Body Jupiter(6)
f6x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_6(1)) / norm(r_1-r_6) ^3 + ...
    m_2 * (r_2(1) - r_6(1)) / norm(r_2 - r_6) ^3 + ...
    m_3 * (r_3(1) - r_6(1)) / norm(r_3 - r_6) ^3 + ...
    m_4 * (r_4(1) - r_6(1)) / norm(r_4 - r_6) ^3 + ...
    m_5 * (r_5(1) - r_6(1)) / norm(r_5 - r_6) ^3 + ...
    m_7 * (r_7(1) - r_6(1)) / norm(r_7 - r_6) ^3 + ...
    m_8 * (r_8(1) - r_6(1)) / norm(r_8 - r_6) ^3 + ...
    m_9 * (r_9(1) - r_6(1)) / norm(r_9 - r_6) ^3 + ...
    m_10 * (r_10(1) - r_6(1)) / norm(r_10 - r_6) ^3);
f6y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_6(2)) / norm(r_1-r_6) ^3 + ...
    m_2 * (r_2(2) - r_6(2)) / norm(r_2 - r_6) ^3 + ...
    m_3 * (r_3(2) - r_6(2)) / norm(r_3 - r_6) ^3 + ...
    m_4 * (r_4(2) - r_6(2)) / norm(r_4 - r_6) ^3 + ...
    m_5 * (r_5(2) - r_6(2)) / norm(r_5 - r_6) ^3 + ...
    m_7 * (r_7(2) - r_6(2)) / norm(r_7 - r_6) ^3 + ...
    m_8 * (r_8(2) - r_6(2)) / norm(r_8 - r_6) ^3 + ...
    m_9 * (r_9(2) - r_6(2)) / norm(r_9 - r_6) ^3 + ...
    m_10 * (r_10(2) - r_6(2)) / norm(r_10 - r_6) ^3);
f6z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_6(3)) / norm(r_1-r_6) ^3 + ...
    m_2 * (r_2(3) - r_6(3)) / norm(r_2 - r_6) ^3 + ...
    m_3 * (r_3(3) - r_6(3)) / norm(r_3 - r_6) ^3 + ...
    m_4 * (r_4(3) - r_6(3)) / norm(r_4 - r_6) ^3 + ...
    m_5 * (r_5(3) - r_6(3)) / norm(r_5 - r_6) ^3 + ...
    m_7 * (r_7(3) - r_6(3)) / norm(r_7 - r_6) ^3 + ...
    m_8 * (r_8(3) - r_6(3)) / norm(r_8 - r_6) ^3 + ...
    m_9 * (r_9(3) - r_6(3)) / norm(r_9 - r_6) ^3 + ...
    m_10 * (r_10(3) - r_6(3)) / norm(r_10 - r_6) ^3);

%Acceleration Body Saturn(7)
f7x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_7(1)) / norm(r_1-r_7) ^3 + ...
    m_2 * (r_2(1) - r_7(1)) / norm(r_2 - r_7) ^3 + ...
    m_3 * (r_3(1) - r_7(1)) / norm(r_3 - r_7) ^3 + ...
    m_4 * (r_4(1) - r_7(1)) / norm(r_4 - r_7) ^3 + ...
    m_5 * (r_5(1) - r_7(1)) / norm(r_5 - r_7) ^3 + ...
    m_6 * (r_6(1) - r_7(1)) / norm(r_6 - r_7) ^3 + ...
    m_8 * (r_8(1) - r_7(1)) / norm(r_8 - r_7) ^3 + ...
    m_9 * (r_9(1) - r_7(1)) / norm(r_9 - r_7) ^3 + ...
    m_10 * (r_10(1) - r_7(1)) / norm(r_10 - r_7) ^3);
f7y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_7(2)) / norm(r_1-r_7) ^3 + ...
    m_2 * (r_2(2) - r_7(2)) / norm(r_2 - r_7) ^3 + ...
    m_3 * (r_3(2) - r_7(2)) / norm(r_3 - r_7) ^3 + ...
    m_4 * (r_4(2) - r_7(2)) / norm(r_4 - r_7) ^3 + ...
    m_5 * (r_5(2) - r_7(2)) / norm(r_5 - r_7) ^3 + ...
    m_6 * (r_6(2) - r_7(2)) / norm(r_6 - r_7) ^3 + ...
    m_8 * (r_8(2) - r_7(2)) / norm(r_8 - r_7) ^3 + ...
    m_9 * (r_9(2) - r_7(2)) / norm(r_9 - r_7) ^3 + ...
    m_10 * (r_10(2) - r_7(2)) / norm(r_10 - r_7) ^3);
f7z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_7(3)) / norm(r_1-r_7) ^3 + ...
    m_2 * (r_2(3) - r_7(3)) / norm(r_2 - r_7) ^3 + ...
    m_3 * (r_3(3) - r_7(3)) / norm(r_3 - r_7) ^3 + ...
    m_4 * (r_4(3) - r_7(3)) / norm(r_4 - r_7) ^3 + ...
    m_5 * (r_5(3) - r_7(3)) / norm(r_5 - r_7) ^3 + ...
    m_6 * (r_6(3) - r_7(3)) / norm(r_6 - r_7) ^3 + ...
    m_8 * (r_8(3) - r_7(3)) / norm(r_8 - r_7) ^3 + ...
    m_9 * (r_9(3) - r_7(3)) / norm(r_9 - r_7) ^3 + ...
    m_10 * (r_10(3) - r_7(3)) / norm(r_10 - r_7) ^3);

%Acceleration Body Uranus(8)
f8x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_8(1)) / norm(r_1-r_8) ^3 + ...
    m_2 * (r_2(1) - r_8(1)) / norm(r_2 - r_8) ^3 + ...
    m_3 * (r_3(1) - r_8(1)) / norm(r_3 - r_8) ^3 + ...
    m_4 * (r_4(1) - r_8(1)) / norm(r_4 - r_8) ^3 + ...
    m_5 * (r_5(1) - r_8(1)) / norm(r_5 - r_8) ^3 + ...
    m_6 * (r_6(1) - r_8(1)) / norm(r_6 - r_8) ^3 + ...
    m_7 * (r_7(1) - r_8(1)) / norm(r_7 - r_8) ^3 + ...
    m_9 * (r_9(1) - r_8(1)) / norm(r_9 - r_8) ^3 + ...
    m_10 * (r_10(1) - r_8(1)) / norm(r_10 - r_8) ^3);
f8y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_8(2)) / norm(r_1-r_8) ^3 + ...
    m_2 * (r_2(2) - r_8(2)) / norm(r_2 - r_8) ^3 + ...
    m_3 * (r_3(2) - r_8(2)) / norm(r_3 - r_8) ^3 + ...
    m_4 * (r_4(2) - r_8(2)) / norm(r_4 - r_8) ^3 + ...
    m_5 * (r_5(2) - r_8(2)) / norm(r_5 - r_8) ^3 + ...
    m_6 * (r_6(2) - r_8(2)) / norm(r_6 - r_8) ^3 + ...
    m_7 * (r_7(2) - r_8(2)) / norm(r_7 - r_8) ^3 + ...
    m_9 * (r_9(2) - r_8(2)) / norm(r_9 - r_8) ^3 + ...
    m_10 * (r_10(2) - r_8(2)) / norm(r_10 - r_8) ^3);
f8z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_8(3)) / norm(r_1-r_8) ^3 + ...
    m_2 * (r_2(3) - r_8(3)) / norm(r_2 - r_8) ^3 + ...
    m_3 * (r_3(3) - r_8(3)) / norm(r_3 - r_8) ^3 + ...
    m_4 * (r_4(3) - r_8(3)) / norm(r_4 - r_8) ^3 + ...
    m_5 * (r_5(3) - r_8(3)) / norm(r_5 - r_8) ^3 + ...
    m_6 * (r_6(3) - r_8(3)) / norm(r_6 - r_8) ^3 + ...
    m_7 * (r_7(3) - r_8(3)) / norm(r_7 - r_8) ^3 + ...
    m_9 * (r_9(3) - r_8(3)) / norm(r_9 - r_8) ^3 + ...
    m_10 * (r_10(3) - r_8(3)) / norm(r_10 - r_8) ^3);

%Acceleration Body Neptune(9)
f9x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_9(1)) / norm(r_1-r_9) ^3 + ...
    m_2 * (r_2(1) - r_9(1)) / norm(r_2 - r_9) ^3 + ...
    m_3 * (r_3(1) - r_9(1)) / norm(r_3 - r_9) ^3 + ...
    m_4 * (r_4(1) - r_9(1)) / norm(r_4 - r_9) ^3 + ...
    m_5 * (r_5(1) - r_9(1)) / norm(r_5 - r_9) ^3 + ...
    m_6 * (r_6(1) - r_9(1)) / norm(r_6 - r_9) ^3 + ...
    m_7 * (r_7(1) - r_9(1)) / norm(r_7 - r_9) ^3 + ...
    m_8 * (r_8(1) - r_9(1)) / norm(r_8 - r_9) ^3 + ...
    m_10 * (r_10(1) - r_9(1)) / norm(r_10 - r_9) ^3);
f9y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_9(2)) / norm(r_1-r_9) ^3 + ...
    m_2 * (r_2(2) - r_9(2)) / norm(r_2 - r_9) ^3 + ...
    m_3 * (r_3(2) - r_9(2)) / norm(r_3 - r_9) ^3 + ...
    m_4 * (r_4(2) - r_9(2)) / norm(r_4 - r_9) ^3 + ...
    m_5 * (r_5(2) - r_9(2)) / norm(r_5 - r_9) ^3 + ...
    m_6 * (r_6(2) - r_9(2)) / norm(r_6 - r_9) ^3 + ...
    m_7 * (r_7(2) - r_9(2)) / norm(r_7 - r_9) ^3 + ...
    m_8 * (r_8(2) - r_9(2)) / norm(r_8 - r_9) ^3 + ...
    m_10 * (r_10(2) - r_9(2)) / norm(r_10 - r_9) ^3);
f9z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_9(3)) / norm(r_1-r_9) ^3 + ...
    m_2 * (r_2(3) - r_9(3)) / norm(r_2 - r_9) ^3 + ...
    m_3 * (r_3(3) - r_9(3)) / norm(r_3 - r_9) ^3 + ...
    m_4 * (r_4(3) - r_9(3)) / norm(r_4 - r_9) ^3 + ...
    m_5 * (r_5(3) - r_9(3)) / norm(r_5 - r_9) ^3 + ...
    m_6 * (r_6(3) - r_9(3)) / norm(r_6 - r_9) ^3 + ...
    m_7 * (r_7(3) - r_9(3)) / norm(r_7 - r_9) ^3 + ...
    m_8 * (r_8(3) - r_9(3)) / norm(r_8 - r_9) ^3 + ...
    m_10 * (r_10(3) - r_9(3)) / norm(r_10 - r_9) ^3);

%Acceleration Body Pluto(10)
f10x = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(1) - r_10(1)) / norm(r_1-r_10) ^3 + ...
    m_2 * (r_2(1) - r_10(1)) / norm(r_2 - r_10) ^3 + ...
    m_3 * (r_3(1) - r_10(1)) / norm(r_3 - r_10) ^3 + ...
    m_4 * (r_4(1) - r_10(1)) / norm(r_4 - r_10) ^3 + ...
    m_5 * (r_5(1) - r_10(1)) / norm(r_5 - r_10) ^3 + ...
    m_6 * (r_6(1) - r_10(1)) / norm(r_6 - r_10) ^3 + ...
    m_7 * (r_7(1) - r_10(1)) / norm(r_7 - r_10) ^3 + ...
    m_8 * (r_8(1) - r_10(1)) / norm(r_8 - r_10) ^3 + ...
    m_9 * (r_9(1) - r_10(1)) / norm(r_9 - r_10) ^3);
f10y = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(2) - r_10(2)) / norm(r_1-r_10) ^3 + ...
    m_2 * (r_2(2) - r_10(2)) / norm(r_2 - r_10) ^3 + ...
    m_3 * (r_3(2) - r_10(2)) / norm(r_3 - r_10) ^3 + ...
    m_4 * (r_4(2) - r_10(2)) / norm(r_4 - r_10) ^3 + ...
    m_5 * (r_5(2) - r_10(2)) / norm(r_5 - r_10) ^3 + ...
    m_6 * (r_6(2) - r_10(2)) / norm(r_6 - r_10) ^3 + ...
    m_7 * (r_7(2) - r_10(2)) / norm(r_7 - r_10) ^3 + ...
    m_8 * (r_8(2) - r_10(2)) / norm(r_8 - r_10) ^3 + ...
    m_9 * (r_9(2) - r_10(2)) / norm(r_9 - r_10) ^3);
f10z = @(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2) G * (m_1 * (r_1(3) - r_10(3)) / norm(r_1-r_10) ^3 + ...
    m_2 * (r_2(3) - r_10(3)) / norm(r_2 - r_10) ^3 + ...
    m_3 * (r_3(3) - r_10(3)) / norm(r_3 - r_10) ^3 + ...
    m_4 * (r_4(3) - r_10(3)) / norm(r_4 - r_10) ^3 + ...
    m_5 * (r_5(3) - r_10(3)) / norm(r_5 - r_10) ^3 + ...
    m_6 * (r_6(3) - r_10(3)) / norm(r_6 - r_10) ^3 + ...
    m_7 * (r_7(3) - r_10(3)) / norm(r_7 - r_10) ^3 + ...
    m_8 * (r_8(3) - r_10(3)) / norm(r_8 - r_10) ^3 + ...
    m_9 * (r_9(3) - r_10(3)) / norm(r_9 - r_10) ^3);


v2x = v_2(1);
v2y = v_2(2);
v2z = v_2(3);
a2x = f2x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a2y = f2y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a2z = f2z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v3x = v_3(1);
v3y = v_3(2);
v3z = v_3(3);
a3x = f3x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a3y = f3y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a3z = f3z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v4x = v_4(1);
v4y = v_4(2);
v4z = v_4(3);
a4x = f4x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a4y = f4y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a4z = f4z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v5x = v_5(1);
v5y = v_5(2);
v5z = v_5(3);
a5x = f5x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a5y = f5y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a5z = f5z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v6x = v_6(1);
v6y = v_6(2);
v6z = v_6(3);
a6x = f6x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a6y = f6y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a6z = f6z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v7x = v_7(1);
v7y = v_7(2);
v7z = v_7(3);
a7x = f7x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a7y = f7y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a7z = f7z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v8x = v_8(1);
v8y = v_8(2);
v8z = v_8(3);
a8x = f8x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a8y = f8y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a8z = f8z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v9x = v_9(1);
v9y = v_9(2);
v9z = v_9(3);
a9x = f9x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a9y = f9y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a9z = f9z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

v10x = v_10(1);
v10y = v_10(2);
v10z = v_10(3);
a10x = f10x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a10y = f10y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
a10z = f10z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);

for j = 1:time/h
    %Mercury
    v2x = v2x + h*a2x;
    v2y = v2y + h*a2y;
    v2z = v2z + h*a2z;
    
    r2x = x_2 + h*v2x;
    r2y = y_2 + h*v2y;
    r2z = z_2 + h*v2z;
    
    r_2 = [r2x;r2y;r2z];
    x_2 = r_2(1);
    y_2 = r_2(2);
    z_2 = r_2(3);
    
    
    %Venus
    v3x = v3x + h*a3x;
    v3y = v3y + h*a3y;
    v3z = v3z + h*a3z;
    
    r3x = x_3 + h*v3x;
    r3y = y_3 + h*v3y;
    r3z = z_3 + h*v3z;
    
    r_3 = [r3x;r3y;r3z];
    x_3 = r_3(1);
    y_3 = r_3(2);
    z_3 = r_3(3);

    %Earth
    v4x = v4x + h*a4x;
    v4y = v4y + h*a4y;
    v4z = v4z + h*a4z;
    
    r4x = x_4 + h*v4x;
    r4y = y_4 + h*v4y;
    r4z = z_4 + h*v4z;
    
    r_4 = [r4x;r4y;r4z];
    x_4 = r_4(1);
    y_4 = r_4(2);
    z_4 = r_4(3);
    
    %Mars
    v5x = v5x + h*a5x;
    v5y = v5y + h*a5y;
    v5z = v5z + h*a5z;
    
    r5x = x_5 + h*v5x;
    r5y = y_5 + h*v5y;
    r5z = z_5 + h*v5z;
    
    r_5 = [r5x;r5y;r5z];
    x_5 = r_5(1);
    y_5 = r_5(2);
    z_5 = r_5(3);
    
    %Jupiter
    v6x = v6x + h*a6x;
    v6y = v6y + h*a6y;
    v6z = v6z + h*a6z;
    
    r6x = x_6 + h*v6x;
    r6y = y_6 + h*v6y;
    r6z = z_6 + h*v6z;
    
    r_6 = [r6x;r6y;r6z];
    x_6 = r_6(1);
    y_6 = r_6(2);
    z_6 = r_6(3);
    
    %Saturn
    v7x = v7x + h*a7x;
    v7y = v7y + h*a7y;
    v7z = v7z + h*a7z;
    
    r7x = x_7 + h*v7x;
    r7y = y_7 + h*v7y;
    r7z = z_7 + h*v7z;
    
    r_7 = [r7x;r7y;r7z];
    x_7 = r_7(1);
    y_7 = r_7(2);
    z_7 = r_7(3);
    
    %Uranus
    v8x = v8x + h*a8x;
    v8y = v8y + h*a8y;
    v8z = v8z + h*a8z;
   
    r8x = x_8 + h*v8x;
    r8y = y_8 + h*v8y;
    r8z = z_8 + h*v8z;
    
    r_8 = [r8x;r8y;r8z];
    x_8 = r_8(1);
    y_8 = r_8(2);
    z_8 = r_8(3);
    
    %Neptune
    v9x = v9x + h*a9x;
    v9y = v9y + h*a9y;
    v9z = v9z + h*a9z;
   
    r9x = x_9 + h*v9x;
    r9y = y_9 + h*v9y;
    r9z = z_9 + h*v9z;
    
    r_9 = [r9x;r9y;r9z];
    x_9 = r_9(1);
    y_9 = r_9(2);
    z_9 = r_9(3);
    
    %Pluto
    v10x = v10x + h*a10x;
    v10y = v10y + h*a10y;
    v10z = v10z + h*a10z;
   
    r10x = x_10 + h*v10x;
    r10y = y_10 + h*v10y;
    r10z = z_10 + h*v10z;
    
    r_10 = [r10x;r10y;r10z];
    x_10 = r_10(1);
    y_10 = r_10(2);
    z_10 = r_10(3);
    
    
    %Update Accelerations
    a2x = f2x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a2y = f2y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a2z = f2z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a3x = f3x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a3y = f3y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a3z = f3z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a4x = f4x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a4y = f4y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a4z = f4z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a5x = f5x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a5y = f5y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a5z = f5z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a6x = f6x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a6y = f6y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a6z = f6z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a7x = f7x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a7y = f7y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a7z = f7z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a8x = f8x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a8y = f8y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a8z = f8z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a9x = f9x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a9y = f9y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a9z = f9z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a10x = f10x(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a10y = f10y(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    a10z = f10z(r_10,r_9,r_8,r_7,r_6,r_5,r_4,r_3,r_2);
    
    a_2keep(:,j) = [a2x;a2y;a2z];
    zeros(3,time/h);
    r_2keep(:,j) = r_2;
    r_3keep(:,j) = r_3;
    r_4keep(:,j) = r_4;
    r_5keep(:,j) = r_5;
    r_6keep(:,j) = r_6;
    r_7keep(:,j) = r_7;
    r_8keep(:,j) = r_8;
    r_9keep(:,j) = r_9;
    r_10keep(:,j) = r_10;
end

toc
%{
figure(1)
plot3(0,0,0,'*')
hold on
plot3(r_2keep(1,:),r_2keep(2,:),r_2keep(3,:),'LineWidth',1)
hold on
plot3(r_3keep(1,:),r_3keep(2,:),r_3keep(3,:),'LineWidth',1)
hold on
plot3(r_4keep(1,:),r_4keep(2,:),r_4keep(3,:),'LineWidth',1)
hold on 
plot3(r_5keep(1,:),r_5keep(2,:),r_5keep(3,:),'LineWidth',1)
hold on
plot3(r_6keep(1,:),r_6keep(2,:),r_6keep(3,:),'LineWidth',1)
hold on
plot3(r_7keep(1,:),r_7keep(2,:),r_7keep(3,:),'LineWidth',1)
hold on
plot3(r_8keep(1,:),r_8keep(2,:),r_8keep(3,:),'LineWidth',1)
hold on
plot3(r_9keep(1,:),r_9keep(2,:),r_9keep(3,:),'LineWidth',1)
hold on
plot3(r_10keep(1,:),r_10keep(2,:),r_10keep(3,:),'LineWidth',1)
grid on
legend('Sun','Mercury','Venus','Earth','Mars','Jupiter','Saturn','Uranus','Pluto')
title('Solar System','Fontsize',20)
xlabel('Meters','Fontsize',16)
ylabel('Meters','Fontsize',16)
zlabel('Meters','Fontsize',16)
set(gcf, 'PaperPositionMode', 'manual')
set(gcf, 'Color', [1 1 1])
set(gca, 'Color', [1 1 1])
set(gcf, 'PaperUnits', 'centimeters')
set(gcf, 'PaperSize', [30 20])
set(gcf, 'Units', 'centimeters' )
set(gcf, 'Position', [0 0 30 20])
set(gcf, 'PaperPosition', [0 0 30 20])
saveas(figure(1),'SolarSystemnormal.png')

figure(2)
plot3(0,0,0,'*')
hold on
plot3(r_2keep(1,:),r_2keep(2,:),r_2keep(3,:),'LineWidth',1)
hold on
plot3(r_3keep(1,:),r_3keep(2,:),r_3keep(3,:),'LineWidth',1)
hold on
plot3(r_4keep(1,:),r_4keep(2,:),r_4keep(3,:),'LineWidth',1)
hold on 
plot3(r_5keep(1,:),r_5keep(2,:),r_5keep(3,:),'LineWidth',1)
grid on
legend('Sun','Mercury','Venus','Earth','Mars','Fontsize',10)
title('Inner Planets','Fontsize',20)
xlabel('Meters','Fontsize',16)
ylabel('Meters','Fontsize',16)
zlabel('Meters','Fontsize',16)
set(gcf, 'PaperPositionMode', 'manual')
set(gcf, 'Color', [1 1 1])
set(gca, 'Color', [1 1 1])
set(gcf, 'PaperUnits', 'centimeters')
set(gcf, 'PaperSize', [30 20])
set(gcf, 'Units', 'centimeters' )
set(gcf, 'Position', [0 0 30 20])
set(gcf, 'PaperPosition', [0 0 30 20])
saveas(figure(2),'innerPlanets.png')

figure(3)
plot3(0,0,0,'*')
hold on
plot3(r_6keep(1,:),r_6keep(2,:),r_6keep(3,:),'LineWidth',1)
hold on
plot3(r_7keep(1,:),r_7keep(2,:),r_7keep(3,:),'LineWidth',1)
hold on
plot3(r_8keep(1,:),r_8keep(2,:),r_8keep(3,:),'LineWidth',1)
hold on
plot3(r_9keep(1,:),r_9keep(2,:),r_9keep(3,:),'LineWidth',1)
hold on
plot3(r_10keep(1,:),r_10keep(2,:),r_10keep(3,:),'LineWidth',1)
grid on
legend('Sun','Jupiter','Saturn','Uranus','Neptune','Pluto')
title('Outer Planets','Fontsize',20)
xlabel('Meters','Fontsize',16)
ylabel('Meters','Fontsize',16)
zlabel('Meters','Fontsize',16)
set(gcf, 'PaperPositionMode', 'manual')
set(gcf, 'Color', [1 1 1])
set(gca, 'Color', [1 1 1])
set(gcf, 'PaperUnits', 'centimeters')
set(gcf, 'PaperSize', [30 20])
set(gcf, 'Units', 'centimeters' )
set(gcf, 'Position', [0 0 30 20])
set(gcf, 'PaperPosition', [0 0 30 20])
saveas(figure(3),'outerPlanets.png')

%}